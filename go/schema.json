{
  "title": "SymLogEntry",
  "type": "object",
  "properties": {
    "meta": {
      "$ref": "#/definitions/LogEntryMeta"
    },
    "run": {
      "$ref": "#/definitions/LogEntryRun"
    },
    "event": {
      "$ref": "#/definitions/LogEntryEvent"
    },
    "actor": {
      "$ref": "#/definitions/LogEntryActor"
    },
    "fields": {
      "title": "Fields",
      "$ref": "#/definitions/LogEntryApprovalFields"
    }
  },
  "required": [
    "meta",
    "run",
    "event",
    "actor",
    "fields"
  ],
  "definitions": {
    "LogEntryMeta": {
      "title": "LogEntryMeta",
      "type": "object",
      "properties": {
        "schema_version": {
          "title": "Schema Version",
          "default": 2,
          "type": "integer"
        }
      }
    },
    "LogEntryRun": {
      "title": "LogEntryRun",
      "type": "object",
      "properties": {
        "srn": {
          "title": "Srn",
          "type": "string",
          "description": "A Sym Resource Name (SRN) is a unique identifier for a Sym Resource.",
          "pattern": "[a-zA-Z0-9-_]+:[a-zA-Z0-9-_]+:[a-zA-Z0-9-_]+:(latest|[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})(:[a-zA-Z0-9-_]+)?",
          "examples": [
            "sym:event:approval:1.0.0:requested"
          ]
        },
        "parent": {
          "title": "Parent",
          "type": "string",
          "description": "A Sym Resource Name (SRN) is a unique identifier for a Sym Resource.",
          "pattern": "[a-zA-Z0-9-_]+:[a-zA-Z0-9-_]+:[a-zA-Z0-9-_]+:(latest|[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})(:[a-zA-Z0-9-_]+)?",
          "examples": [
            "sym:event:approval:1.0.0:requested"
          ]
        },
        "flow": {
          "title": "Flow",
          "type": "string",
          "description": "A Sym Resource Name (SRN) is a unique identifier for a Sym Resource.",
          "pattern": "[a-zA-Z0-9-_]+:[a-zA-Z0-9-_]+:[a-zA-Z0-9-_]+:(latest|[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})(:[a-zA-Z0-9-_]+)?",
          "examples": [
            "sym:event:approval:1.0.0:requested"
          ]
        }
      },
      "required": [
        "srn",
        "flow"
      ]
    },
    "LogEntryEvent": {
      "title": "LogEntryEvent",
      "type": "object",
      "properties": {
        "srn": {
          "title": "Srn",
          "type": "string",
          "description": "A Sym Resource Name (SRN) is a unique identifier for a Sym Resource.",
          "pattern": "[a-zA-Z0-9-_]+:[a-zA-Z0-9-_]+:[a-zA-Z0-9-_]+:(latest|[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})(:[a-zA-Z0-9-_]+)?",
          "examples": [
            "sym:event:approval:1.0.0:requested"
          ]
        },
        "type": {
          "title": "Type",
          "type": "string"
        },
        "template": {
          "title": "Template",
          "type": "string",
          "description": "A Sym Resource Name (SRN) is a unique identifier for a Sym Resource.",
          "pattern": "[a-zA-Z0-9-_]+:[a-zA-Z0-9-_]+:[a-zA-Z0-9-_]+:(latest|[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})(:[a-zA-Z0-9-_]+)?",
          "examples": [
            "sym:event:approval:1.0.0:requested"
          ]
        },
        "timestamp": {
          "title": "Timestamp",
          "type": "string",
          "format": "date-time"
        }
      },
      "required": [
        "srn",
        "type",
        "template",
        "timestamp"
      ]
    },
    "LogEntryIdentity": {
      "title": "LogEntryIdentity",
      "description": "This object will also contain any fields contained in the specific Identity (e.g. the User ID of a Slack User).",
      "type": "object",
      "properties": {
        "service": {
          "title": "Service",
          "type": "string"
        },
        "external_id": {
          "title": "External Id",
          "type": "string"
        }
      },
      "required": [
        "service",
        "external_id"
      ],
      "additionalProperties": true
    },
    "LogEntryActor": {
      "title": "LogEntryActor",
      "type": "object",
      "properties": {
        "user": {
          "title": "User",
          "type": "string",
          "description": "A Sym Resource Name (SRN) is a unique identifier for a Sym Resource.",
          "pattern": "[a-zA-Z0-9-_]+:[a-zA-Z0-9-_]+:[a-zA-Z0-9-_]+:(latest|[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})(:[a-zA-Z0-9-_]+)?",
          "examples": [
            "sym:event:approval:1.0.0:requested"
          ]
        },
        "name": {
          "title": "Name",
          "type": "string"
        },
        "username": {
          "title": "Username",
          "type": "string"
        },
        "identity": {
          "$ref": "#/definitions/LogEntryIdentity"
        }
      },
      "required": [
        "user",
        "name",
        "identity"
      ]
    },
    "LogEntryTarget": {
      "title": "LogEntryTarget",
      "type": "object",
      "properties": {
        "name": {
          "title": "Name",
          "type": "string"
        },
        "srn": {
          "title": "Srn",
          "type": "string",
          "description": "A Sym Resource Name (SRN) is a unique identifier for a Sym Resource.",
          "pattern": "[a-zA-Z0-9-_]+:[a-zA-Z0-9-_]+:[a-zA-Z0-9-_]+:(latest|[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})(:[a-zA-Z0-9-_]+)?",
          "examples": [
            "sym:event:approval:1.0.0:requested"
          ]
        },
        "type": {
          "title": "Type",
          "type": "string"
        },
        "label": {
          "title": "Label",
          "type": "string"
        },
        "settings": {
          "title": "Settings",
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        }
      },
      "required": [
        "name",
        "srn",
        "type",
        "label",
        "settings"
      ]
    },
    "LogEntryApprovalFields": {
      "title": "LogEntryApprovalFields",
      "description": "This object will also contain all of the user-supplied fields.",
      "type": "object",
      "properties": {
        "reason": {
          "title": "Reason",
          "type": "string"
        },
        "duration": {
          "title": "Duration",
          "type": "integer"
        },
        "target": {
          "$ref": "#/definitions/LogEntryTarget"
        }
      },
      "required": [
        "reason",
        "duration",
        "target"
      ],
      "additionalProperties": true
    },
    "LogEntryFields": {
      "title": "LogEntryFields",
      "description": "This object will also contain all of the user-supplied fields.",
      "type": "object",
      "properties": {},
      "additionalProperties": true
    }
  },
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "examples": [
    {
      "meta": {
        "schema_version": 2
      },
      "run": {
        "srn": "health-health:run:CF45667E-06ED-4333-A963-31AF108497A1:latest",
        "parent": "health-health:run:75E6A968-6151-4BF3-AC8A-EC64638D03FC:latest",
        "flow": "health-health:flow:iam-access:1.2.3"
      },
      "event": {
        "template": "sym:template:approval:1.0.0",
        "srn": "sym:event:approval:latest:escalate",
        "type": "escalate",
        "timestamp": "2021-11-04T21:53:22+00:00"
      },
      "actor": {
        "user": "healthy-health:user:ABBA3D4B-2CF3-4FA3-AFFC-5D562AAD9BC5:latest",
        "name": "Ben Bitdiddle",
        "username": "ben@bitdiddle.com",
        "identity": {
          "service": "slack",
          "external_id": "TABC123",
          "user_id": "UABC123"
        }
      },
      "fields": {
        "urgency": "Emergency",
        "duration": 30,
        "reason": "foobar",
        "target": {
          "srn": "healthy-health:target:test-target:latest",
          "type": "aws_iam_group",
          "name": "test-target",
          "label": "Test Target",
          "settings": {
            "iam_group": "prod-break-glass"
          }
        }
      }
    }
  ],
  "description": "This model is sent by Sym both to Log Destinations for [reporting](https://docs.symops.com/docs/reporting), as well as for the [HTTP](https://docs.symops.com/docs/http) and [AWS Lambda](https://docs.symops.com/docs/aws-lambda) Strategies."
}
